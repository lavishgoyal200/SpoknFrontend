import{i as v,l as N}from"./runtime-GQ2FS7C6.js";import{R as c,m as j,D as f,U as w}from"./runtime-rpc-0IXjfGUg.js";var s;(function(e){e[e.cancelled=0]="cancelled",e[e.unknown=1]="unknown",e[e.invalid_argument=2]="invalid_argument",e[e.malformed=3]="malformed",e[e.deadline_exceeded=4]="deadline_exceeded",e[e.not_found=5]="not_found",e[e.bad_route=6]="bad_route",e[e.already_exists=7]="already_exists",e[e.permission_denied=8]="permission_denied",e[e.unauthenticated=9]="unauthenticated",e[e.resource_exhausted=10]="resource_exhausted",e[e.failed_precondition=11]="failed_precondition",e[e.aborted=12]="aborted",e[e.out_of_range=13]="out_of_range",e[e.unimplemented=14]="unimplemented",e[e.internal=15]="internal",e[e.unavailable=16]="unavailable",e[e.dataloss=17]="dataloss"})(s||(s={}));function x(e,t,n){if(n)for(let[i,l]of Object.entries(n))if(typeof l=="string")e.append(i,l);else for(let r of l)e.append(i,r);return e.set("Content-Type",t?"application/json":"application/protobuf"),e.set("Accept",t?"application/json":"application/protobuf, application/json"),e}function P(e){if(!v(e)||typeof e.code!="string"||typeof e.msg!="string")return new c("cannot read twirp error response",s[s.internal]);let t={};if(v(e.meta))for(let[n,i]of Object.entries(e.meta))typeof i=="string"&&(t[n]=i);return new c(e.msg,e.code,t)}function U(e){let t={};return e.forEach((n,i)=>{i.toLowerCase()!=="content-type"&&i.toLowerCase()!=="content-length"&&(t.hasOwnProperty(i)?t[i].push(n):t[i]=n)}),t}class J{constructor(t){this.defaultOptions=t}mergeOptions(t){return j(this.defaultOptions,t)}unary(t,n,i){var l,r,d;let o=i,h=this.makeUrl(t,o),_=(l=o.fetchInit)!==null&&l!==void 0?l:{},O=o.sendJson?t.I.toJsonString(n,o.jsonOptions):t.I.toBinary(n,o.binaryOptions),p=new f,g=new f,b=new f,y=new f;return globalThis.fetch(h,Object.assign(Object.assign({},_),{method:"POST",headers:x(new globalThis.Headers,!!o.sendJson,o.meta),body:O,signal:(r=i.abort)!==null&&r!==void 0?r:null})).then(a=>{p.resolve(U(a.headers));let u;try{u=a.type}catch{}switch(u){case"error":case"opaque":case"opaqueredirect":throw new c(`fetch response type ${a.type}`,s[s.unknown])}return a.ok?o.sendJson?a.json().then(m=>t.O.fromJson(m,o.jsonOptions),()=>{throw new c("unable to read response body as json",s[s.dataloss])}):a.arrayBuffer().then(m=>t.O.fromBinary(new Uint8Array(m),o.binaryOptions),()=>{throw new c("unable to read response body",s[s.dataloss])}):a.json().then(m=>{throw P(m)},()=>{throw new c("received HTTP "+a.status+", unable to read response body as json",s[s.internal])})},a=>{throw a instanceof Error&&a.name==="AbortError"?new c(a.message,s[s.cancelled]):new c(a instanceof Error?a.message:a)}).then(a=>{g.resolve(a),b.resolve({code:"OK",detail:""}),y.resolve({})}).catch(a=>{let u=a instanceof c?a:new c(a instanceof Error?a.message:a,s[s.internal]);u.methodName=t.name,u.serviceName=t.service.typeName,p.rejectPending(u),g.rejectPending(u),b.rejectPending(u),y.rejectPending(u)}),new w(t,(d=o.meta)!==null&&d!==void 0?d:{},n,p.promise,g.promise,b.promise,y.promise)}makeUrl(t,n){let i=n.baseUrl;i.endsWith("/")&&(i=i.substring(0,i.length-1));let l=t.name;return n.useProtoMethodName!==!0&&(l=N(l),l=l.substring(0,1).toUpperCase()+l.substring(1)),`${i}/${t.service.typeName}/${l}`}clientStreaming(t){const n=new c("Client streaming is not supported by Twirp",s[s.unimplemented]);throw n.methodName=t.name,n.serviceName=t.service.typeName,n}duplex(t){const n=new c("Duplex streaming is not supported by Twirp",s[s.unimplemented]);throw n.methodName=t.name,n.serviceName=t.service.typeName,n}serverStreaming(t){const n=new c("Server streaming is not supported by Twirp",s[s.unimplemented]);throw n.methodName=t.name,n.serviceName=t.service.typeName,n}}export{s as T,J as a};
