import{l as d,m as f,a as v}from"./runtime-GQ2FS7C6.js";function E(r,t){var e,s,n;let i=r;return i.service=t,i.localName=(e=i.localName)!==null&&e!==void 0?e:d(i.name),i.serverStreaming=!!i.serverStreaming,i.clientStreaming=!!i.clientStreaming,i.options=(s=i.options)!==null&&s!==void 0?s:{},i.idempotency=(n=i.idempotency)!==null&&n!==void 0?n:void 0,i}class _{constructor(t,e,s){this.typeName=t,this.methods=e.map(n=>E(n,this)),this.options=s??{}}}class O extends Error{constructor(t,e="UNKNOWN",s){super(t),this.name="RpcError",Object.setPrototypeOf(this,new.target.prototype),this.code=e,this.meta=s??{}}toString(){const t=[this.name+": "+this.message];this.code&&(t.push(""),t.push("Code: "+this.code)),this.serviceName&&this.methodName&&t.push("Method: "+this.serviceName+"/"+this.methodName);let e=Object.entries(this.meta);if(e.length){t.push(""),t.push("Meta:");for(let[s,n]of e)t.push(`  ${s}: ${n}`)}return t.join(`
`)}}function w(r,t){if(!t)return r;let e={};u(r,e),u(t,e);for(let s of Object.keys(t)){let n=t[s];switch(s){case"jsonOptions":e.jsonOptions=v(r.jsonOptions,e.jsonOptions);break;case"binaryOptions":e.binaryOptions=f(r.binaryOptions,e.binaryOptions);break;case"meta":e.meta={},u(r.meta,e.meta),u(t.meta,e.meta);break;case"interceptors":e.interceptors=r.interceptors?r.interceptors.concat(n):n.concat();break}}return e}function u(r,t){if(!r)return;let e=t;for(let[s,n]of Object.entries(r))n instanceof Date?e[s]=new Date(n.getTime()):Array.isArray(n)?e[s]=n.concat():e[s]=n}var o;(function(r){r[r.PENDING=0]="PENDING",r[r.REJECTED=1]="REJECTED",r[r.RESOLVED=2]="RESOLVED"})(o||(o={}));class j{constructor(t=!0){this._state=o.PENDING,this._promise=new Promise((e,s)=>{this._resolve=e,this._reject=s}),t&&this._promise.catch(e=>{})}get state(){return this._state}get promise(){return this._promise}resolve(t){if(this.state!==o.PENDING)throw new Error(`cannot resolve ${o[this.state].toLowerCase()}`);this._resolve(t),this._state=o.RESOLVED}reject(t){if(this.state!==o.PENDING)throw new Error(`cannot reject ${o[this.state].toLowerCase()}`);this._reject(t),this._state=o.REJECTED}resolvePending(t){this._state===o.PENDING&&this.resolve(t)}rejectPending(t){this._state===o.PENDING&&this.reject(t)}}var y=function(r,t,e,s){function n(i){return i instanceof e?i:new e(function(a){a(i)})}return new(e||(e=Promise))(function(i,a){function h(c){try{l(s.next(c))}catch(p){a(p)}}function m(c){try{l(s.throw(c))}catch(p){a(p)}}function l(c){c.done?i(c.value):n(c.value).then(h,m)}l((s=s.apply(r,t||[])).next())})};class b{constructor(t,e,s,n,i,a,h){this.method=t,this.requestHeaders=e,this.request=s,this.headers=n,this.response=i,this.status=a,this.trailers=h}then(t,e){return this.promiseFinished().then(s=>t?Promise.resolve(t(s)):s,s=>e?Promise.resolve(e(s)):Promise.reject(s))}promiseFinished(){return y(this,void 0,void 0,function*(){let[t,e,s,n]=yield Promise.all([this.headers,this.response,this.status,this.trailers]);return{method:this.method,requestHeaders:this.requestHeaders,request:this.request,headers:t,response:e,status:s,trailers:n}})}}function g(r,t,e,s,n){var i;{let a=(h,m,l)=>t.unary(h,m,l);for(const h of((i=s.interceptors)!==null&&i!==void 0?i:[]).filter(m=>m.interceptUnary).reverse()){const m=a;a=(l,c,p)=>h.interceptUnary(m,l,c,p)}return a(e,n,s)}}export{j as D,O as R,_ as S,b as U,w as m,g as s};
